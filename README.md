Postman Adoption Starter Kit - Payment Domain

## Business Case
**Problem:** Currently, developers spend ~47 minutes manually configuring environments and auth for every new API they consume.
**Solution:** This Starter Kit reduces that Discovery time to **<2 minutes** by automating the ingestion, configuration, and mock authentication setup.

## Setup
1. **Clone Repo:**
   ```bash
   git clone https://github.com/seanriney/postman-adoption-starter-kit.git
   cd postman-adoption-starter-kit
   ```
2. **Set Environment Variables:**
   ```bash
   # Windows PowerShell
   $env:POSTMAN_API_KEY = "PMAK-your-api-key-here"
   $env:POSTMAN_WORKSPACE_NAME = "My Workspace"  # Optional: defaults to "My Workspace"
   
   # Mac/Linux
   export POSTMAN_API_KEY="PMAK-your-api-key-here"
   export POSTMAN_WORKSPACE_NAME="My Workspace"  # Optional: defaults to "My Workspace"
   ```
   
   **Workspace Options:**
   - Set `POSTMAN_WORKSPACE_NAME` to target a workspace by name
   - Or set `POSTMAN_WORKSPACE_ID` for exact ID targeting
   - If neither is set, defaults to "My Workspace"
   
   See `.env.example` for configuration template.

3. **Run Automation:**
   ```bash
   python ingest_api.py
   ```
4. **Result:**
   - Open your Postman Workspace.
   - You will see the **Payment Refund API** spec.
   - You will see a generated **Collection** with Mock Auth pre-installed.
   - You will see an **Environment** configured with Dev/QA/UAT/Prod URLs.

## ROI Calculation
By automating the "Day 0" setup, I save 47 minutes (approx 0.78 hrs) per engineer, per API interaction.

**Formula:**
`14 Engineers * 0.78 Hours (saved) * 2 APIs/Week * 52 Weeks * $150/hr`

**Total Annual Savings:** **~$170,352 / year**

*Note: This only accounts for "Discovery" time. It does not include savings from reduced defects (QA) or faster onboarding.*

## Scaling Strategy
This script uses a **"Spec-First"** architecture that is content-agnostic.
To scale this to the other 46 APIs:
1. **Centralize:** Place all 47 YAML files in a central repo or folder.
2. **Loop:** Modify `ingest_api.py` to iterate through the folder:
   ```python
   import glob
   # Loop pattern
   for spec_file in glob.glob("./specs/*.yaml"):
       ingest_spec(spec_file) # Wrap logic in function
   ```
3. **Pipeline:** Move the script logic into a GitHub Action (see `.github/workflows/` example) to trigger on every Spec merge.

## Governance & Workspace Rationalization
**Problem:** The org has 413 ad-hoc workspaces, leading to "Zombie Collections".
**Solution:**
1. **Source of Truth:** The YAML spec dictates the Postman Collection in a **Standardized Workspace**.
2. **Standardization:** Every API ingested gets the same Environment structure and Auth placeholders.
3. **Drift Prevention:** By regenerating collections from the Spec, we prevent manual changes that drift from reality.
4. **Consolidation:** Archive the 2,918 ad-hoc collections and direct all 1,440 users to the "Golden" collections generated by this pipeline.

## Technical Decisions

### API Endpoint Selection: v10 API Builder vs. v9 Spec Hub

**Case Study Specification:** The requirements initially specified using `POST /specs` endpoints.

**Implementation Decision:** I use `POST /apis` + `POST /import/openapi` (v10 API Builder pattern).

**Rationale:**

Research revealed that Postman underwent an architectural migration from v9 "Spec Hub" to v10 "API Builder" ([Postman API Introduction](https://learning.postman.com/docs/developer/postman-api/intro-api/)). The `/specs` endpoint is officially deprecated and resides in Postman's [DEPRECATED endpoints folder](https://www.postman.com/postman/postman-public-workspace/folder/0a4bnwe/deprecated).

**Key Changes in v10:**
1. **Multi-File Specifications:** v10 supports splitting OpenAPI files into multiple files (paths/, components/, schemas/), requiring a new `files` array payload structure.
2. **Workflow Hierarchy:** v10 uses API → Version → Schema instead of the flat Spec Hub structure.
3. **Bidirectional Sync:** Collections and Specs now sync two-way, replacing one-way generation.

**Testing Performed:**
- 10+ payload variations attempted on `/specs` endpoint
- All returned `400 Bad Request` errors
- Tested exact v10 payload structure (still failed)
- `/specs` endpoint path itself no longer exists in v10

**Validation:**
The v10 implementation using `/apis` successfully creates APIs, imports specifications, generates collections, and configures environments in **under 30 seconds**.

**Documentation:** See `DEVELOPMENT_LOG.md` for complete diagnostic evidence.
